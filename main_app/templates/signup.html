{% extends 'base.html' %}

{% comment %} main_app/templates/signup.html {% endcomment %}

{% block content %}
  <h1>Sign Up</h1>

  {% if error_message %}
    <p class="error">{{ error_message }}</p>
  {% endif %}

  <form method="post" novalidate>
    {% csrf_token %}

    <label>
      <input type="checkbox" name="organization" id="org-check" />
      Sign up as an Organization
    </label>

    <div>
      {{ user_form.as_p }}
    </div>

    <div id="org-form" style="display: none;">
      {{ organization_form.as_p }}
    </div>

    <div id="volunteer-form">
      {{ volunteer_form.as_p }}
    </div>

    <button type="submit">Sign Up</button>
  </form>

  <script>
    const checkbox = document.getElementById('org-check');
    const orgForm = document.getElementById('org-form');
    const volunteerForm = document.getElementById('volunteer-form');

    function toggleForms() {
      if (checkbox.checked) {
        orgForm.style.display = 'block';
        volunteerForm.style.display = 'none';

        // Disable volunteer fields, enable org fields
        volunteerForm.querySelectorAll('input, select, textarea').forEach(el => el.disabled = true);
        orgForm.querySelectorAll('input, select, textarea').forEach(el => el.disabled = false);
      } else {
        orgForm.style.display = 'none';
        volunteerForm.style.display = 'block';

        // Disable org fields, enable volunteer fields
        orgForm.querySelectorAll('input, select, textarea').forEach(el => el.disabled = true);
        volunteerForm.querySelectorAll('input, select, textarea').forEach(el => el.disabled = false);
      }
    }

    checkbox.addEventListener('change', toggleForms);
    window.addEventListener('load', toggleForms);
  </script>
{% endblock %}
